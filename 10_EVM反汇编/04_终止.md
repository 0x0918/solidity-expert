# 第4节：5个终止指令介绍

[Reversing and Debugging EVM Smart contracts: 5 Instructions to end/abort the Execution](https://medium.com/@TrustChain/reversing-and-debugging-evm-the-end-of-time-part-4-3eafe5b0511a)



## 1. Stop

消耗0gas，不返回任何数据。

```js
// SPDX-License-Identifier: UNLICENSED
pragma solidity ^0.8.0;

contract Test {
    function test() external {

    }
}
```

得到汇编如下：

```js
045 JUMPDEST |function signature discarded|
046 PUSH1 33 |0x33|
048 PUSH1 35 |0x35|0x33|
050 JUMP     |0x33|
053 JUMPDEST |0x33|
054 JUMP     ||
051 JUMPDEST ||
052 STOP     ||
053 JUMPDEST
054 JUMP
```

注意50 byte时，跳转到0x35（53 byte）位置，54byte时，进一步跳转到0x33处（51 byte）位置，最后STOP退出，此时内存中数据为空，栈中只有signature，所以返回数据为空。



## 2. Return

```js
// SPDX-License-Identifier: UNLICENSED
pragma solidity ^0.8.0;

contract Test {
    function test() external returns(uint) {
        return(8);
    }
}
```

得到汇编如下：（打开优化开关，run 1）

```js
045 JUMPDEST ||
046 PUSH1 08 |0x08|  the return value of test()
048 PUSH1 40 |0x40|0x08|
050 MLOAD    |0x80|0x08|  mload(0x40) mloads the free memory pointer（内存中的值不会被清除或覆盖）
051 SWAP1    |0x08|0x80|
052 DUP2     |0x80|0x08|0x80|（DUP2的意思是，复制栈上第2个元素，即下标为1的元素）
053 MSTORE   |0x80|       mstore(0x80,0x08) store the return value in memory[0x80]
054 PUSH1 20 |0x20|0x80|
056 ADD      |0xa0|
057 PUSH1 40 |0x40|0xa0|
059 MLOAD    |0x80|0xa0|
060 DUP1     |0x80|0x80|0xa0|
061 SWAP2    |0xa0|0x80|0x80|
062 SUB      |0x20|0x80|
063 SWAP1    |0x80|0x20|
064 RETURN   ||
```





## 3. Revert

## 4. Invalid

## 5. SelfDestruct
